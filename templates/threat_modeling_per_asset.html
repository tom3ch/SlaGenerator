{% extends 'base.html' %}

{% block content %}

<style>
    #back{
        position: absolute;
        left: 80%;
        top: 10%;
    }
</style>

<div class="starter-template" style="margin-top: -6%;"> </div>
<h1>Threat model</h1>

<table class="table">
    <thead>
        <tr>
            <th style="width:50%"><h3>Threat List for {{ asset.name }}</h3></th>
        </tr>
    </thead>
    <tbody>
        {% for threat in threats %}
            <tr>
                <td style="font-family: 'Times New Roman';font-size: larger">
                <b>Name</b> : {{ threat.0.name }} <br />
                <b>Description</b> : {{ threat.0.description }}
                <br />
                <b>Source</b> : {{ threat.0.source }} <br />
                {% if threat.1 %}
                    <b>Stride:</b> {% for stride in threat.1 %} {{ stride }}{% if not forloop.last %},{% endif %}{% endfor %}
                    <br />
                {% endif %}
                {% if threat.2 %}
                    <b>Compromised Security Requirement</b> : {% for requirement in threat.2 %} {{ requirement }}{% if not forloop.last %},{% endif %}{% endfor %}
                    <br />
                {% endif %}
                {% if threat.3 and threat.3 != 'none' %}
                    <!-- <b>Role in Protocol</b> : {% for role in threat.3 %} {{ role }}{% if not forloop.last %},{% endif %}{% endfor %} -->
                    <b>Role in Protocol</b> : {{ threat.3 }}
                    <br />
                {% endif %}
            </tr>
        {% endfor %}
    </tbody>
</table>
<table class="table">
    <thead>
        <tr>
            <th style="width:50%"><h3>Neighbouring Threat List</h3></th>
        </tr>
    </thead>
    <tbody>
        {% for threat in neighbour_threats %}
            <tr>
                <td style="font-family: 'Times New Roman';font-size: larger">
                <b>Name</b> : {{ threat.name }} <br />
                <b>Description</b> : {{ threat.description }}
                <br />
                <b>Source</b> : {{ threat.source }}
            </tr>
        {% endfor %}
    </tbody>
</table>
{% if not threats %}
    <b>Threats not found!</b>
{% endif %}

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
{% endblock %}